<% if item.succeeded? %>
  <p class='bulkrax-p-align'>
    <strong>Succeeded At:</strong> <%= item.status_at %>
  </p>
<% elsif item.failed? %>
  <div class="accordion-container">
    <div class="accordion-heading" role="tab" id="error-trace-heading">
      <a class="accordion-title" role="button" data-toggle="collapse" data-target="#error-trace-show" aria-expanded="true" aria-controls="error-trace-show">
        Current Error:
      </a>
      <a role="button" data-toggle="collapse" data-target="#error-trace-show" aria-expanded="true" aria-controls="error-trace-show">
        <div class="accordion-icon fa fa-times-circle" aria-hidden="true"></div>
      </a>
    </div>
    <div id="error-trace-show" class="accordion-collapse collapse" role="tabpanel" aria-labelledby="error-trace-show">
      <div class="accordion-body">
        <div class="bulkrax-nav-tab-bottom-margin">
          <!-- Toggle buttons -->
          <div class="btn-group pull-right" role="group" aria-label="...">
            <button id="full-errors-tab" type="button" class="btn btn-default active"><a href="#bulkrax-full-toggle-1" aria-controls="bulkrax-full-toggle-1" role="tab" data-toggle="tab">Full</a></button>
            <button id="raw-errors-tab" type="button" class="btn btn-default"><a href="#bulkrax-raw-toggle-1" aria-controls="bulkrax-raw-toggle-1" role="tab" data-toggle="tab">Raw</a></button>
          </div>
          <!-- Tab panes -->
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="bulkrax-full-toggle-1">
              <strong>Errored at:</strong> <%= item.status_at %><br /><br />
              <strong>Error:</strong> <%= item.current_status.error_class %> - <%= item.current_status.error_message %><br /><br />
              <strong>Error Trace:</strong><br/><br />
              <% item.current_status.error_backtrace.each do |v| %>
                <%= coderay(v, { wrap: :page, css: :class, tab_width: 200, break_lines: true }) %>
                <br>
              <% end %>
            </div>
            <div role="tabpanel" class="tab-pane" id="bulkrax-raw-toggle-1">
              <strong>Errored at:</strong> <%= item.status_at %><br /><br />
              <strong>Error:</strong> <%= item.current_status.error_class %> - <%= item.current_status.error_message %><br /><br />
              <strong>Error Trace:</strong><br/><br />
              <% item.current_status.error_backtrace.each do |v| %>
                <%= coderay(v, { css: :class, tab_width: 0, break_lines: false }) %>
                <br>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>

<div class="accordion-container">
  <div class="accordion-heading" role="tab" id="error-trace-heading">
    <a class="accordion-title" role="button" data-toggle="collapse" data-target="#error-trace-show" aria-expanded="true" aria-controls="error-trace-show">
      All Statuses:
    </a>
    <a role="button" data-toggle="collapse" data-target="#error-trace-show" aria-expanded="true" aria-controls="error-trace-show">
      <div class="accordion-icon fa fa-times-circle" aria-hidden="true"></div>
    </a>
  </div>
  <div id="error-trace-show" class="accordion-collapse collapse" role="tabpanel" aria-labelledby="error-trace-show">
    <div class="accordion-body">
      <div class="bulkrax-nav-tab-bottom-margin">
        <!-- Toggle buttons -->
        <div class="btn-group pull-right" role="group" aria-label="...">
          <button id="full-errors-tab" type="button" class="btn btn-default active"><a href="#bulkrax-full-toggle-1" aria-controls="bulkrax-full-toggle-1" role="tab" data-toggle="tab">Full</a></button>
          <button id="raw-errors-tab" type="button" class="btn btn-default"><a href="#bulkrax-raw-toggle-1" aria-controls="bulkrax-raw-toggle-1" role="tab" data-toggle="tab">Raw</a></button>
        </div>
        <!-- Tab panes -->
        <div class="tab-content">
          <% item.statuses.map do |item_status| %>
            <div role="tabpanel" class="tab-pane active" id="bulkrax-full-toggle-1">
              <strong>Occured at:</strong> <%= item_status.updated_at %><br /><br />
              <strong>Link to Status Page:</strong> <%= <%= link_to "Status Details", statuses_path(item_status.id) %>%>
              <strong>Message:</strong> <%= item_status.error_class %> - <%= item_status.error_message %><br /><br />
            </div>
            <div role="tabpanel" class="tab-pane" id="bulkrax-raw-toggle-1">
              <strong>Occured at:</strong> <%= item_status.updated_at %><br /><br />
              <strong>Link to Status Page:</strong> <%= <%= link_to "Status Details", statuses_path(item_status.id) %>%>
              <strong>Message:</strong> <%= item_status.error_class %> - <%= item_status.error_message %><br /><br />
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
